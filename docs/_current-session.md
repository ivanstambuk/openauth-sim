# Current Session Snapshot

> Keep this file up to date across all active chats. Treat it as the single source of truth for in-progress workstreams so every hand-off is instant. Replace the bracketed text and prune sections you do not need.

- Date: 2025-11-11
- Primary branch: `main`
- Other active branches: none
- Last green commands: `./gradlew --no-daemon spotlessApply check` (2025-11-10 – Feature 005 template migration verification), `./gradlew --no-daemon spotlessApply check` (2025-11-10 – Feature 004 template migration verification), `./gradlew --no-daemon spotlessApply check` (2025-11-10 – Feature 003 template migration verification), `./gradlew --no-daemon spotlessApply check` (2025-11-10 – Feature 002 template migration verification), `./gradlew --no-daemon spotlessApply check` (2025-11-10 – Feature 001 template migration verification), `./gradlew --no-daemon spotlessApply check` (2025-11-10 – template migration sweep for Features 036/029/041/039/026), `OPENAPI_SNAPSHOT_WRITE=true ./gradlew --no-daemon :rest-api:test --tests "io.openauth.sim.rest.OpenApiSnapshotTest"` (2025-11-09 – provenance schema snapshot regenerated), `./gradlew --no-daemon --console=plain :application:test`, `./gradlew --no-daemon --console=plain :cli:test`, `./gradlew --no-daemon --console=plain :rest-api:test` (full EMV + EUDIW suites), `./gradlew --no-daemon --console=plain :ui:test`, `./gradlew --no-daemon --console=plain pmdMain pmdTest`, `./gradlew --no-daemon --console=plain spotlessApply check`, `node --test rest-api/src/test/javascript/emv/console.test.js`, and `OPENAUTH_SIM_PERSISTENCE_DATABASE_PATH=build/tmp/test-credentials.db ./gradlew --no-daemon :rest-api:test --tests "io.openauth.sim.rest.ui.EmvCapOperatorUiSeleniumTest"`. All commands completed successfully after copying `trace-provenance-example.json` into `rest-api/docs/test-vectors/emv-cap/`. Additional doc-only verification: `./gradlew --no-daemon spotlessApply check` (2025-11-09 – Implementation Drift Gate sweep) remained green after the roadmap/how-to updates.
- Build status: Feature 039’s Implementation Drift Gate is complete—console assets render all six provenance sections, REST/CLI/application layers honour `includeTrace` opt-outs, the canonical fixture now lives in both `docs/test-vectors` and `rest-api/docs/test-vectors`, the drift report is logged, and the aggregate Gradle gate is green. Feature 040 is unblocked and can resume at T4018 (console alias/history wiring + verbose builder consolidation) while Feature 041 planning remains unchanged.
- Template migration (2025-11-10): Feature 001 spec/plan/tasks converted to the refreshed templates (FR/NFR tables, S-001 scenarios, T-001 tasks), migration tracker updated, and the verification log now references the latest spotless/check run; awaiting owner review before directory renumbering.
- Template migration (2025-11-10): Feature 002 spec/plan/tasks now adopt the refreshed templates (metadata tables, FR/NFR catalogue, interface catalogue, Spec DSL, and templated task checklist). Migration tracker + session log updated.
- Template migration (2025-11-10): Feature 003 spec/plan/tasks converted to the refreshed templates (metadata tables, FR/NFR catalogue, API/telemetry catalogues, Spec DSL, templated tasks). Migration tracker + session log updated.
- Template migration (2025-11-10): Feature 004 spec/plan/tasks now follow the refreshed templates (metadata tables, FR/NFR catalogue, interface & telemetry catalogues, Spec DSL, templated tasks). Migration tracker updated; Feature 005 is next in the protocol-first backlog.
- Template migration (2025-11-10): Feature 006 spec/plan/tasks upgraded to the refreshed templates (FR/NFR tables, S-006 scenarios, T-006 tasks, updated Spec DSL) and logged in the migration tracker; ready for owner sign-off ahead of directory renumbering.
- Template migration (2025-11-10): Feature 007 spec/plan/tasks now match the refined templates (metadata table, FR/NFR catalogue, S-007 scenarios, T-007 tasks, refreshed Spec DSL plus CLI/REST/Java guide intent notes); docs/migration_plan.md and this session log record the progress so directory renumbering can continue.
- Template migration (2025-11-10): Feature 008 spec/plan/tasks converted to the refreshed templates (metadata table, FR/NFR catalogue, S-008 scenarios, T-008 tasks, Spec DSL for quality-gate automation); migration tracker updated so the renumbering workstream can proceed.
- Template migration (2025-11-10): Feature 009 spec/plan/tasks now follow the updated templates (metadata table, FR/NFR catalogue, S-009 scenarios, T-009 tasks, Spec DSL, telemetry/benchmark notes); migration tracker updated accordingly.
- Template migration (2025-11-10): Feature 010 spec/plan/tasks now match the refreshed templates (metadata table, FR/NFR catalogue, S-010 scenarios, T-010 tasks, Spec DSL, updated plan/tasks increments). docs/migration_plan.md captures the sweep; directory renumbering stays paused until the remaining legacy features migrate.
- Template migration (2025-11-10): Feature 011 spec/plan/tasks now adopt the refreshed templates (metadata table, FR/NFR catalogue, S-011 scenarios, interface catalogue, Spec DSL, increment map, templated tasks). Migration tracker updated; Feature 012 leads the remaining backlog before renumbering resumes.
- Template migration (2025-11-10): Feature 012 spec/plan/tasks now comply with the refreshed templates (metadata table, FR/NFR catalogue, S-012 scenarios, CLI command catalogue, Spec DSL, increment map, templated tasks). Migration tracker updated; Feature 013 is next in the backlog ahead of renumbering.
- Template migration (2025-11-10): Feature 013 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-013 scenarios, interface & CLI catalogues, Spec DSL, increment map, templated tasks). Migration tracker updated; Feature 014 is next before renumbering resumes.
- Template migration (2025-11-10): Feature 014 spec/plan/tasks now align with the refreshed templates (metadata table, FR/NFR catalogue, S-014 scenarios, interface/telemetry catalogues, Spec DSL, increment map, templated tasks). Migration tracker updated; Feature 015 is next before renumbering resumes.
- Template migration (2025-11-10): Feature 015 spec/plan/tasks now comply with the refreshed templates (metadata table, FR/NFR catalogue, S-015 scenarios, interface/fixture catalogues, Spec DSL, increment map, templated tasks). Migration tracker updated; Feature 016 is next ahead of directory renumbering.
- Template migration (2025-11-10): Feature 016 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-016 scenario matrix, interface/telemetry catalogues, Spec DSL, templated tasks). Migration tracker + session log updated; Feature 017 is queued next once priorities land.
- Template migration (2025-11-10): Feature 017 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-017 scenario matrix, interface & fixture catalogues, ASCII mock-up, Spec DSL, templated tasks). Migration tracker + session snapshot updated; next backlog item is preparing the console workstream for directory renumbering.
- Template migration (2025-11-10): Feature 018 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-018 scenario matrix, interface catalogue, Spec DSL, templated plan/tasks). Migration tracker updated; renumbering remains paused per directive.
- Template migration (2025-11-10): Feature 019 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-019 scenario matrix, interface catalogue, Spec DSL, templated tasks). Migration tracker updated; hook governance stays in sync while renumbering is paused.
- Template migration (2025-11-10): Feature 020 spec/plan/tasks now match the refreshed templates (metadata table, FR/NFR catalogue, S-020 scenario matrix, interface catalogue, ASCII mock-up, Spec DSL, templated tasks). Roadmap references updated; renumbering continues to be paused until all features migrate.
- Template migration (2025-11-10): Feature 021 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-021 scenario matrix, interface catalogue, ASCII mock-up, Spec DSL, templated tasks). Embeddable asset docs verified; renumbering remains paused per directive.
- Template migration (2025-11-10): Feature 022 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-022 scenario matrix, interface catalogue, Spec DSL, templated checklist). Fixture catalogue references updated; renumbering still on hold until migrations finish.
- Template migration (2025-11-10): Feature 023 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-023 scenario matrix, interface catalogue, Spec DSL, templated checklist). TOTP fixture/docs verified; renumbering remains paused per directive.
- Template migration (2025-11-10): Feature 024 spec/plan/tasks now adopt the refreshed templates (metadata table, FR/NFR catalogue, S-024 scenario matrix, interface/fixture catalogues, Spec DSL, templated checklist). WebAuthn router/preset docs refreshed; renumbering stays paused until the sweep finishes.
- Template migration (2025-11-10): Feature 025 spec/plan/tasks now match the refreshed templates (metadata table, FR/NFR catalogue, S-025 scenario matrix, interface/fixture catalogues, ASCII mock-up, Spec DSL, templated checklist). docs/migration_plan.md + this session log reflect the sweep; roadmap/workflow docs stay synced while directory renumbering remains paused.
- Template migration (2025-11-10): Feature 026 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue with FR-026 IDs, S-026 scenario matrix, interface/fixture catalogues, Spec DSL, templated plan/tasks with legacy log appendix). Migration tracker + session log updated; renumbering still paused.
- Template migration (2025-11-10): Feature 027 spec/plan/tasks now align with the refreshed templates (metadata table, FR/NFR catalogue, S-027 scenario matrix, interface/log catalogue, Spec DSL, templated tasks). docs/migration_plan.md updated; renumbering directive still in effect until the sweep completes.
- Template migration (2025-11-10): Feature 028 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-028 scenario matrix, interface/log catalogue, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering remains paused.
- Template migration (2025-11-10): Feature 030 spec/plan/tasks now align with the refreshed templates (metadata table, FR/NFR catalogue, S-030 scenario matrix, interface/catalogue entries, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering remains paused.
- Template migration (2025-11-10): Feature 031 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-031 scenario matrix, interface/catalogue entries, Spec DSL, templated checklist). docs/migration_plan.md updated; renumbering directive still in effect.
- Template migration (2025-11-10): Feature 032 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-032 scenario matrix, interface/catalogue entries, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering still paused.
- Template migration (2025-11-10): Feature 033 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-033 scenario matrix, interface/catalogue entries, Spec DSL, templated checklist). docs/migration_plan.md updated; renumbering remains paused.
- Template migration (2025-11-10): Feature 034 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-034 scenario matrix, interface/catalogue entries, Spec DSL, templated checklist). docs/migration_plan.md updated; renumbering still paused.
- Template migration (2025-11-10): Feature 035 spec/plan/tasks now use the refreshed templates (metadata table, FR/NFR catalogue, S-035 scenario matrix, interface/catalogue entries, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering still paused.
- Template migration (2025-11-11): Feature 036 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-036 scenario matrix, interface/catalogue entries, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering directive still in effect.
- Template migration (2025-11-11): Feature 037 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-037 scenario matrix, interface/catalogue entries, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering directive still in effect.
- Template migration (2025-11-11): Feature 038 spec/plan/tasks now follow the refreshed templates (metadata table, FR/NFR catalogue, S-038 scenario matrix, interface/catalogue entries, Spec DSL, templated plan/tasks). docs/migration_plan.md updated; renumbering directive still in effect.
- New workstream kickoff (2025-11-07): Feature 041 – Operator Console JavaScript Modularization & Test Harness now has a Draft specification, feature plan, and tasks checklist; roadmap entry #40 created and the spec remains open so future protocol additions can extend it.
- Clarifications (2025-11-01): EUDIW OpenID4VP simulator scope confirmed—remote OpenID4VP flows only; credential formats include SD-JWT VC plus ISO/IEC 18013-5 mdoc; align with HAIP profile; simulator covers verifier+wallet roles; adopt hybrid fixture strategy (synthetic now, ingest EU conformance vectors when available). 2025-11-06 update: wallet simulator recomputes SD-JWT disclosure hashes from supplied disclosures (Option A).
- Clarifications (2025-11-05): EMV/CAP operator Evaluate panel keeps inline mode active when a sample vector is selected; no automatic switch to stored credential mode.
- Quality gate note: Full pipeline `./gradlew --no-daemon :application:test :cli:test :rest-api:test :ui:test pmdMain pmdTest spotlessApply check` completed 2025-11-05 (Jacoco aggregated report regenerated; branch coverage remains 2161/3087 ≈0.7000) alongside refreshed OpenAPI snapshots for the sanitised EMV credential directory schema.

## Workstream Summary
| Workstream | Status | Last Increment | Next Increment | Notes |
|------------|--------|----------------|----------------|-------|
| Feature 039 – EMV/CAP Simulation Services | In review | T3952 – Implementation Drift Gate | Owner acceptance hand-off | Drift Gate verifies spec R1–R10 coverage, dual `trace-provenance-example.json` fixtures stay mirrored, roadmap/how-to docs now carry the sync requirement, and `./gradlew --no-daemon spotlessApply check` remained green post-doc sweep. 2025-11-10: spec/plan/tasks refreshed to the latest templates (metadata table, verification log) ahead of acceptance. Awaiting owner sign-off before archiving the workstream. |
| Feature 026 – FIDO2/WebAuthn Attestation Support | In review | I45 – Stored credential secret sanitisation | Owner acceptance sign-off | Sanitisation merged (`bcaad35`): stored credential samples expose only signing key handles + `[stored-server-side]` placeholders; full suite green (2025-11-05). 2025-11-10: spec/plan/tasks migrated to the new template (metadata tables, FR/NFR, interface catalogue, task log). Awaiting owner confirmation to mark the workstream complete. |
| Feature 029 – PMD Rule Hardening | In progress | T2903 (Ruleset expansion & baseline) | T2902 – Governance sync & backlog updates | 2025-11-10: Spec/plan/tasks migrated to the new templates with metadata tables, catalogue entries, and task intents; PMD toolVersion bumped to 7.17.0 with dependency locks refreshed via `--write-locks`; legacy `AssignmentInOperand` findings refactored and `./gradlew --no-daemon pmdMain pmdTest` stays green with NonExhaustiveSwitch enabled. |
| Feature 036 - Verbose Trace Tier Controls | Proposed | — | T-036-01 - Tier helper specification tests (red) | 2025-11-11: Spec, plan, and tasks rewritten to the refreshed templates (metadata table, FR/NFR catalogue, S-036 scenario matrix, interface catalogues, Spec DSL, templated increments/tasks). Implementation still pending; next action is to stage failing helper tests under I1/T-036-01. |
| Feature 041 – Operator Console JS Modularization & Test Harness | Planning | New spec/plan/tasks seeded 2025-11-07 | T4101 – Console asset inventory & extraction notes | 2025-11-10: Spec/plan/tasks refreshed to the new template, including harness DSL + governance checklists; workstream remains Draft until console suites land. |
| Feature 040 – EUDIW OpenID4VP Simulator | In progress | T-040-23 – Live Trusted Authority ingestion | I11 – Drift gate + final documentation | Owner directive Option A executed 2025-11-10: Features 036/029/041 migrated to new templates. 2025-11-10 follow-up: Feature 040 spec/plan/tasks now use the refined templates (FR/NFR tables, S-040 scenarios, T-040 tasks) with T4018/T4019/T4020 already green and T-040-23 queued before Drift Gate finalisation. |
| _Reminder_ |  |  |  | Keep this table limited to active workstreams; move completed features to the roadmap instead of tracking them here. |

> Open questions live exclusively in `docs/4-architecture/open-questions.md`; consult that log for any pending clarifications.

## Reference Links
- Roadmap entries: `docs/4-architecture/roadmap.md` (Workstreams 27, 34, 35, 40)
- Additional spec: `docs/4-architecture/features/029/spec.md`
- Additional plan: `docs/4-architecture/features/029/plan.md`
- Additional tasks: `docs/4-architecture/features/029/tasks.md`
- Additional spec: `docs/4-architecture/features/036/spec.md`
- Additional plan: `docs/4-architecture/features/036/plan.md`
- Additional tasks: `docs/4-architecture/features/036/tasks.md`
- Spec (Feature 041): `docs/4-architecture/features/041/spec.md`
- Plan (Feature 041): `docs/4-architecture/features/041/plan.md`
- Tasks (Feature 041): `docs/4-architecture/features/041/tasks.md`
- Spec (Feature 040): `docs/4-architecture/features/040/spec.md`
- Plan (Feature 040): `docs/4-architecture/features/040/plan.md`
- Tasks (Feature 040): `docs/4-architecture/features/040/tasks.md`
- Quick reference: `docs/5-operations/session-quick-reference.md`

> Update this snapshot before ending each session and after significant context changes.
