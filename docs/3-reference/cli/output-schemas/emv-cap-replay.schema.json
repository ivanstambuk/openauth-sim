{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "cli.emv.cap.replay",
  "type": "object",
  "required": ["status", "reasonCode", "metadata"],
  "properties": {
    "status": { "type": "string" },
    "reasonCode": { "type": "string" },
    "metadata": {
      "type": "object",
      "required": ["credentialSource", "mode"],
      "properties": {
        "credentialSource": { "type": "string" },
        "credentialId": { "type": "string" },
        "mode": { "type": "string" },
        "driftBackward": { "type": "integer" },
        "driftForward": { "type": "integer" },
        "matchedDelta": { "type": "integer" }
      },
      "additionalProperties": true
    },
    "trace": { "type": "object" }
  },
  "additionalProperties": true,
  "examples": [
    {
      "status": "match",
      "reasonCode": "match",
      "metadata": {
        "credentialSource": "stored",
        "mode": "RESPOND",
        "driftBackward": 0,
        "driftForward": 0
      },
      "trace": {
        "masterKeySha256": "sha256:...",
        "sessionKey": "5EC8B9...",
        "atc": "00C8",
        "branchFactor": 4,
        "height": 8,
        "maskLength": 8,
        "previewWindow": {
          "backward": 0,
          "forward": 0
        },
        "generateAcInput": {
          "terminal": "0000000000000000000000000000800000000000000000000000000000",
          "icc": "100000C8A50006040000"
        },
        "generateAcResult": "8000...",
        "bitmask": "....1F...........FFFFF..........8...",
        "maskedDigitsOverlay": "....14...........45643..........8...",
        "issuerApplicationData": "06770A03A48000",
        "iccPayloadTemplate": "1000XXXXA50006040000",
        "iccPayloadResolved": "100000C8A50006040000"
      }
    }
  ]
}
